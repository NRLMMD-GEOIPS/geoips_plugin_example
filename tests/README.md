#### # # Distribution Statement A. Approved for public release. Distribution unlimited.
#### # # 
#### # # Author:
#### # # Naval Research Laboratory, Marine Meteorology Division
#### # # 
#### # # This program is free software:
#### # # you can redistribute it and/or modify it under the terms
#### # # of the NRLMMD License included with this program.
#### # # 
#### # # If you did not receive the license, see
#### # # https://github.com/U-S-NRL-Marine-Meteorology-Division/
#### # # for more information.
#### # # 
#### # # This program is distributed WITHOUT ANY WARRANTY;
#### # # without even the implied warranty of MERCHANTABILITY
#### # # or FITNESS FOR A PARTICULAR PURPOSE.
#### # # See the included license for more details.

Running test scripts
--------------------
```
# Run an individual test script - each test script must return 0 for successful run, or non-zero for failed
$GEOIPS_PACKAGES_DIR/geoips_template_plugin/tests/scripts/<script_name>.sh

# Test ALL functionality within the current repo
$GEOIPS_PACKAGES_DIR/geoips_template_plugin/tests/test_all.sh
```

Creating a new test repo
------------------------
Create a new test data repo for your data type, and populate it with data and appropriate sector information.
Create an empty "outputs" directory which you will later populate with valid test output.
```
mkdir -p $GEOIPS_BASEDIR/test_data/test_data_<type>
mkdir $GEOIPS_BASEDIR/test_data/test_data_<type>/data
mkdir $GEOIPS_BASEDIR/test_data/test_data_<type>/outputs
mkdir $GEOIPS_BASEDIR/test_data/test_data_<type>/sectors
```

Creating a new test script
--------------------------
Ensure you have the appropriate versions of all dependencies for consistent test outputs!!
Ensure you are on the appropriate branch!!
```
$GEOIPS_PACKAGES_DIR/geoips/setup.sh install
$GEOIPS_PACKAGES_DIR/geoips/setup.sh install_cartopy_offlinedata
$GEOIPS_PACKAGES_DIR/geoips/setup.sh update_test_repo test_data_<type> <branch_name>
```

Now create a script that calls the appropriate run_procflow command(s), and exits with 0 if all processing
was completed successfully, and exits with a non-zero return code if any processing failed.

To ensure known output was produced correctly, run_procflow should be called with the --compare_path option.


Updating new test outputs
-------------------------

Once you've created a new test script, and produced valid test outputs, update the test repo and test_all.sh script:
```
# Copy new files into test repos
# scripts are autogenerated to copy currently processed outputs into the
# comparison directory specified by --compare_path in the run_procflow command
source tests/outputs/abi_aws/Infrared-Test_image/diff_test_output_$USER/cp_MISSINGCOMPARE.txt

# Delete all the unnecessary files from the test repos
# scripts are autogenerated to delete existing files in the comparison directory that were NOT
# successfully produced during the current run.
source tests/outputs/abi_aws/Infrared-Test_image/diff_test_output_$USER/rm_MISSINGPRODUCT.txt

cd $GEOIPS_BASEDIR/test_data/test_data_<type>
# git commit appropriately
# git push

# Add your new call to test_all.sh so we ensure it is in the testing rotation:
# add something like
#   "$GEOIPS_PACKAGES_DIR/geoips_template_plugin/tests/scripts/abi_aws.sh"
# to test_all.sh
vim $GEOIPS_PACKAGES_DIR/geoips_template_plugin/tests/test_all.sh
```
